# MindSPONGE

- [Description](#Description)
- [Dataset](#Dataset)
- [Environment Requirements](#Environment-Requirements)
- [Quick Start](#Quick-Start)
- [Script Description](#Script-Description)
    - [Script and Sample Code](#Script-and-Sample-Code)
    - [Simulation Process](#Simulation-Process)
- [Result](#Result)

## Description

MindSPONGE implemented functions for molecular modeling and many simulation cases in biology，material and drug designing, which are not only simulated in traditional molecular simulation method, but also in AI method. Your contribution and attention are very important to us!

The following example demonstrates how to perform high-performance molecular dynamics simulations with the built-in MindSPONGE module on a `GPU`.

## Dataset

There are three inputs in the example, the property file `NVT_290_10ns.in`, the topology file `WATER_ALA.parm7` and the coordinates file `WATER_ALA_350_cool_290.rst7`, respectivelly. They are stored in `data/polypeptide`.

![ALA Aqueous System](https://images.gitee.com/uploads/images/2021/0323/184453_4bd9b1a6_8142020.png "图片1.png")

The topology file and coordinates file can be generated by `tleap` in `AmberTools` ([link](<http://ambermd.org/GetAmber.php>)). For more details, please refer to:

- [MindSPONGE Tutorial](https://gitee.com/mindspore/mindscience/tree/master/MindSPONGE/mindsponge/examples)

## Environment Requirements

- Hardware: `GPU`
    - Prepare a hardware environment with `GPU`.
- Framework
    - [MindSpore](https://www.mindspore.cn/install/en)
- For more information, visit the resources below:
    - [MindSPONGE Tutorials](https://gitee.com/mindspore/mindscience/tree/master/MindSPONGE/mindsponge/examples)
    - [MindSpore Python API](https://www.mindspore.cn/docs/api/en/master/index.html)

## Quick Start

After installing MindSpore, run the following command:

```shell
python main_poly.py --i /path/NVT_290_10ns.in \
               --amber_parm /path/WATER_ALA.parm7 \
               --c /path/WATER_ALA_350_cool_290.rst7 \
               --o /path/ala_NVT_290_10ns.out
```

`path` is the path which stores input files. In this case, they are stored in `data/polypeptide`.

## Script Description

### Script and Sample Code

```shell
├── sponge
    ├── README.md
    ├── main.py                                  # launch Simulation for MindSPONGE
    ├── main_poly.py                             # launch Simulation for MindSPONGE
    ├── md
        ├── space
            ├── md_information.py                    # save md information module
            ├── system_information.py                # subclass of md information
        ├── partition
            ├── neighbor_list.py                     # neighbor_list module
        ├── control
            ├── langevin_liujian_md.py               # langevin_liujian_md module
            ├── mc_baro.py                           # Monte Carlo pressure control method
            ├── bd_baro.py                           # Berendsen pressure control method
            ├── crd_molecular_map.py                 # molecular map module
        ├── potential
            ├── bond.py                              # bond module
            ├── angle.py                             # angle module
            ├── dihedral.py                          # dihedral module
            ├── nb14.py                              # nb14 module
            ├── lennard_jones.py                     # lennard_jones module
            ├── particle_mesh_ewald.py               # particle_mesh_ewald module
            ├── restrain.py                          # restrain module
            ├── simple_constrain.py                  # simple constrain module
            ├── vatom.py                             # virtual atoms
        ├── simulation.py                        # MindSPONGE simulation
        ├── simulation_poly.py                   # MindSPONGE simulation for polypeptide
```

### Simulation

```shell
python main_poly.py --i /path/NVT_290_10ns.in \
               --amber_parm /path/WATER_ALA.parm7 \
               --c /path/WATER_ALA_350_cool_290.rst7 \
               --o /path/ala_NVT_290_10ns.out
```

Simulation result will be stored in the specified .out file.

## Result

After training, the following results are stored in `ala_NVT_290_10ns.out`:

```text
_steps_ _TEMP_ _TOT_POT_ENE_ _BOND_ENE_ _ANGLE_ENE_ _DIHEDRAL_ENE_ _14LJ_ENE_ _14CF_ENE_ _LJ_ENE_ _CF_PME_ENE_
      0 0.000   -5713.804         0.037       0.900         14.909      9.072    194.477  765.398    -6698.648
   ...
```

There are sorts of energy in the output, steps (_steps_), temperature (_TEMP_), total energy (_TOT_POT_E_), bond energy (_BOND_ENE_), angle energy (_ANGLE_ENE_), dihedral energy (_DIHEDRAL_ENE_), non-bond energy, includes Coulomb force (_14CF_ENE_) and Lennard-Jones energy (_14LJ_ENE_), Van der Waals energy (_LJ_ENE_) and Coulomb force in PME (_CF_PME_ENE_).
